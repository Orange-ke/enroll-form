webpackJsonp([1],{"+c27":function(e,t){},"1zY8":function(e,t){},"4ml/":function(e,t){},"4rJS":function(e,t){},"5ZkD":function(e,t){},"7Otq":function(e,t,n){e.exports=n.p+"static/img/logo.b7c38c4.png"},CGQl:function(e,t){},Coeh:function(e,t){},Gypb:function(e,t){},HY0d:function(e,t){},JKiR:function(e,t){},JsOw:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("qVvv");var a=n("8aUD"),o=n("7+uW"),i=(n("4ml/"),n("SHZo")),l=n("mtWM"),s=n.n(l),r=n("/ocq"),c=(n("3Lne"),n("SSsa")),d=(n("eqfM"),n("/QYm")),u=n("mvHQ"),v=n.n(u),f=this,p=function(e){return/^[1][3-9]\d{9}$|^[0][0][8][5][2|3][6|9]\d{6,7}$/.test(e)},h=function(){return"micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},m=function(e){alert(v()(e.data)),WeixinJSBridge.invoke("getBrandWCPayRequest",e.data,function(e){try{WeixinJSBridge.log(e.err_msg),"get_brand_wcpay_request:ok"===e.err_msg?window.location.href=window.location.protocol+"//"+window.location.host+"/step4":("get_brand_wcpay_request:fail"===e.err_msg&&d.a.fail("支付失败， 请尝试重新支付"),"get_brand_wcpay_request:cancel"===e.err_msg&&d.a.fail("取消支付"))}catch(e){alert(e.message),console.log(v()(e.message))}})},g=function(e,t){console.log(e.width,e.height);var n=Math.random()*e.width,a=Math.random()*e.height,o=Math.random()+.01,i=.5*Math.random()*Math.pow(-1,Math.floor(2*Math.random()+1)),l=.5*Math.random()*Math.pow(-1,Math.floor(2*Math.random()+1));t.push({x:n,y:a,r:o,vx:i,vy:l})},_=function(e){var t=[],n=e.$refs.canvas,a=n.getContext("2d");n.width=document.documentElement.clientWidth,n.height=document.documentElement.clientHeight,a.fillStyle="rgba(255, 152, 0, 0.1)",a.strokeStyle="rgba(255, 152, 0, 0.1)",a.lineWidth=.5;for(var o=0;o<20;o++)g(n,t);!function e(){a.clearRect(0,0,n.width,n.height),function(e,t,n,a){for(var o=0;o<e;o++)n.save(),n.beginPath(),n.arc(a[o].x,a[o].y,a[o].r,0,2*Math.PI),n.stroke(),n.restore();for(var i=0;i<e;i++)for(var l=i+1;l<e;l++)s=a[i],r=a[l],Math.sqrt(Math.pow(s.x-r.x,2)+Math.pow(s.y-r.y,2))<200&&(n.beginPath(),n.moveTo(a[i].x,a[i].y),n.lineTo(a[l].x,a[l].y),n.stroke());for(var s,r,c=0;c<e;c++)a[c].x+=a[c].vx,a[c].y+=a[c].vy,a[c].x-a[c].r>t.width&&(a[c].x=0-a[c].r),a[c].x+a[c].r<0&&(a[c].x=t.width+a[c].r),a[c].y-a[c].r>t.height&&(a[c].y=0-a[c].r),a[c].y+a[c].r<0&&(a[c].y=t.height+a[c].r)}(20,n,a,t),requestAnimationFrame(e)}()},I={data:function(){return{}},mounted:function(){_(this)},methods:{linkToStep:function(){window.sessionStorage.getItem("token")?this.$router.push({name:"Step1"}):this.$router.push({name:"QueryInfo",params:{type:"1"}})},linkToInfo:function(){window.sessionStorage.getItem("token")?this.$router.push({name:"Info"}):this.$router.push({name:"QueryInfo",params:{type:"2"}})}},components:{"van-button":c.a}},b={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form"},[n("canvas",{ref:"canvas",staticClass:"canvas"}),e._v(" "),n("div",{staticClass:"content"},[e._m(0),e._v(" "),n("div",{staticClass:"btnGroup"},[n("van-button",{staticClass:"brown-btn",staticStyle:{"margin-top":"30px"},attrs:{type:"default",size:"large",round:""},on:{click:e.linkToStep}},[e._v("我要报名")]),e._v(" "),n("van-button",{staticClass:"brown-btn",staticStyle:{"margin-top":"30px"},attrs:{type:"default",size:"large",round:""},on:{click:e.linkToInfo}},[e._v("已报名 查看报名信息")])],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("img",{attrs:{src:n("7Otq"),alt:"",width:"100%"}})])}]};var w=n("VU/8")(I,b,!1,function(e){n("UTD0")},"data-v-6f973417",null).exports,C=(n("zP7x"),n("rD0v")),y=(n("3AsM"),n("7ZPY")),x=(n("WJbf"),n("OhwO")),S=(n("v2ns"),n("7QTg")),k={data:function(){return{images:["https://img.yzcdn.cn/vant/apple-2.jpg","https://img.yzcdn.cn/vant/apple-2.jpg"],eventConfig:{title:"澳之星俺们赛区少年组舞蹈比赛火热报名中！！！",time:"2019-08-19",location:"澳门机场",zone:"澳门赛区",info:"这次赛事非常好看这次赛事非常好看这次赛事非常好看这次赛事非常好看这次赛事非常好看这次赛事非常好看这次赛事非常好看这次赛事非常好看",imagesDetail:[]},swiperOption:{slidesPerView:3,spaceBetween:30},swiperSlides:["https://img.yzcdn.cn/vant/apple-2.jpg","https://img.yzcdn.cn/vant/apple-2.jpg","https://img.yzcdn.cn/vant/apple-2.jpg","https://img.yzcdn.cn/vant/apple-2.jpg","https://img.yzcdn.cn/vant/apple-2.jpg","https://img.yzcdn.cn/vant/apple-2.jpg"]}},methods:{linkToStep:function(){this.$router.push("/step1")},linkToInfo:function(){this.$router.push("/queryInfo")},preview:function(e){console.log(e.target.getAttribute("src"));var t=e.target.getAttribute("src");Object(x.a)({images:[t]})}},components:{"van-button":c.a,"van-swipe":y.a,"van-swipe-item":C.a,swiper:S.swiper,"swiper-slide":S.swiperSlide}},z={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("van-swipe",{attrs:{autoplay:3e3}},e._l(e.images,function(e,t){return n("van-swipe-item",{key:t},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"image"}],attrs:{width:"100%",height:"100%"}})])}),1),e._v(" "),n("div",{staticClass:"detail"},[n("div",{staticClass:"title"},[e._v("\n      "+e._s(e.eventConfig.title)+"\n    ")]),e._v(" "),n("div",{staticClass:"time"},[n("span",[e._v("比赛时间: ")]),e._v(" "),n("span",[e._v(e._s(e.eventConfig.time))])]),e._v(" "),n("div",{staticClass:"location"},[n("span",[e._v("比赛时间: ")]),e._v(" "),n("span",[e._v(e._s(e.eventConfig.location))])]),e._v(" "),n("div",{staticClass:"zone"},[e._v("\n      "+e._s(e.eventConfig.zone)+"\n    ")]),e._v(" "),n("div",{staticClass:"detailInfo"},[n("div",{staticClass:"detailTitle"},[e._v("活动详情")]),e._v(" "),n("div",{staticClass:"detailContent"},[e._v("\n        "+e._s(e.eventConfig.info)+"\n      ")]),e._v(" "),n("div",{staticClass:"slider"},[n("swiper",{attrs:{options:e.swiperOption}},e._l(e.swiperSlides,function(t,a){return n("swiper-slide",{key:a},[n("img",{attrs:{src:t,alt:"slider",width:"100%"},on:{click:e.preview}})])}),1)],1)]),e._v(" "),n("div",{staticClass:"btnGroup"},[n("van-button",{staticClass:"brown-btn",staticStyle:{"margin-top":"30px"},attrs:{type:"default",size:"large",round:""},on:{click:e.linkToStep}},[e._v("我要报名")]),e._v(" "),n("van-button",{staticClass:"brown-btn",staticStyle:{"margin-top":"30px"},attrs:{type:"default",size:"large",round:""},on:{click:e.linkToInfo}},[e._v("已报名 查看报名信息")])],1)])],1)},staticRenderFns:[]};var E=n("VU/8")(k,z,!1,function(e){n("PCFi")},"data-v-3a467ec0",null).exports,T=(n("k3b4"),n("+2ln")),A=(n("PEgo"),n("HNZ3")),M=(n("MY4N"),n("0zAV")),$=(n("i0mo"),n("Hkar")),F={data:function(){return{type:"1",phone:"",loading:!1,sms:"",showCode:!1,zone:0,mobileCode:"+86",codeActions:[{name:"+86",value:0,id:"86"},{name:"+853",value:1,id:"853"},{name:"+852",value:2,id:"852"},{name:"+856",value:3,id:"856"}]}},mounted:function(){_(this);var e=this.$route.params.type;e&&(this.type=e)},methods:{selectCode:function(){this.showCode=!0},onCodeSelect:function(e){console.log(e),this.mobileCode=e.name,this.zone=e.value,this.showCode=!1},validation:function(){var e=this.sms.trim(),t=this.phone.trim(),n=this.mobileCode;return""===t?(d.a.fail("请输入手机号"),!1):p(t)?6!==e.length?(d.a.fail("验证码有误！"),!1):{mobile_code:n,mobile:t,verify_code:e}:(d.a.fail("请输入正确的手机号"),!1)},toEnroll:function(){if(console.log("toEnroll"),this.validation()){var e=this.validation();console.log(e);var t=this;d.a.loading({mask:!0,message:"加载中...",duration:0}),this.login(e,function(n){d.a.clear(),console.log(n),s.a.defaults.headers={token:n.token},window.sessionStorage.setItem("phoneConfig",v()(e)),window.sessionStorage.setItem("token",n.token),t.$router.push("/step1")},function(e){d.a.clear(),d.a.fail(e)})}},onSubmit:function(){if(console.log("submit"),this.validation()){var e=this.validation();console.log(e);var t=this;d.a.loading({mask:!0,message:"加载中...",duration:0}),this.login(e,function(e){d.a.clear(),console.log(e),s.a.defaults.headers={token:e.token},window.sessionStorage.setItem("token",e.token),t.$router.push("/info")},function(e){d.a.clear(),d.a.fail(e)})}},login:function(e,t,n){s.a.post("api/Login/mobile",e).then(function(e){console.log(e),200===e.data.code?t(e.data.data):n("身份校验失败，请重试！")}).catch(function(e){console.log(e),n(e.response.data.msg)})},sendSmsCode:function(e){console.log(e.target);var t=this.phone.trim();if(!p(t)||""===t)return d.a.fail("您输入的联系方式有误！"),!1;e.target.setAttribute("disabled",!0),this.sendCode({mobile:t,mobileCode:this.mobileCode},function(){var t=60,n=setInterval(function(){t--,e.target.innerText=t+"秒后重试",t<1&&(e.target.removeAttribute("disabled"),e.target.innerText="发送验证码",clearInterval(n))},1e3)},function(t){d.a.fail(t),e.target.removeAttribute("disabled")})},sendCode:function(e,t,n){var a=this;this.loading=!0,s.a.post("api/Sms/index",e).then(function(e){console.log(e),200===e.data.code?(a.loading=!1,t()):(a.loading=!1,n("发送失败请稍后重试！"))}).catch(function(e){a.loading=!1,n(e.response.data.msg)})}},components:{"van-button":c.a,"van-cell-group":$.a,"van-field":M.a,"van-action-sheet":A.a,"van-icon":T.a}},j={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form"},[n("canvas",{ref:"canvas",staticClass:"canvas"}),e._v(" "),n("div",{staticClass:"content"},[e._m(0),e._v(" "),n("van-cell-group",{staticClass:"round-corner group golden"},[n("div",{staticClass:"title align-center"},[e._v("\n        "+e._s("1"===e.type?"去报名":"查询信息")+"\n      ")]),e._v(" "),n("van-field",{staticStyle:{"line-height":"50px"},attrs:{border:!1,required:"","input-align":"left",placeholder:"请输入手机号"},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}},[n("div",{staticClass:"phone-label",attrs:{slot:"label"},slot:"label"},[n("span",[e._v("联系电话")]),e._v(" "),n("span",{staticClass:"two",on:{click:e.selectCode}},[n("span",[e._v(e._s(e.mobileCode))]),e._v(" "),n("van-icon",{attrs:{name:"arrow-down"}})],1)])]),e._v(" "),n("van-action-sheet",{attrs:{actions:e.codeActions},on:{select:e.onCodeSelect},model:{value:e.showCode,callback:function(t){e.showCode=t},expression:"showCode"}}),e._v(" "),n("van-field",{attrs:{center:"",clearable:"",required:"",label:"短信验证码",placeholder:"请输入验证码"},model:{value:e.sms,callback:function(t){e.sms=t},expression:"sms"}},[n("van-button",{staticClass:"smsButton",attrs:{slot:"button",loading:e.loading,plain:"",size:"small",type:"default"},on:{click:e.sendSmsCode},slot:"button"},[e._v("发送验证码\n        ")])],1)],1),e._v(" "),"2"===e.type?n("van-button",{staticClass:"submit-btn one",attrs:{round:"",size:"large",type:"default"},on:{click:e.onSubmit}},[e._v("\n      查询\n    ")]):e._e(),e._v(" "),"1"===e.type?n("van-button",{staticClass:"submit-btn one",attrs:{round:"",size:"large",type:"default"},on:{click:e.toEnroll}},[e._v("\n      登录\n    ")]):e._e()],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("img",{attrs:{src:n("7Otq"),alt:"",width:"100%"}})])}]};var L=n("VU/8")(F,j,!1,function(e){n("1zY8")},"data-v-5392526b",null).exports,R=(n("HZGa"),n("pykS")),V=(n("le1z"),n("hZxG")),P=(n("OWWB"),n("1fWZ")),q=(n("+GXX"),n("fTPy")),O=(n("uCzd"),n("t8KH")),D=(n("XmAh"),n("il3B")),B={data:function(){return{active:3,enrollInfo:{name:"",gender:"",zone:"",group:"",idType:"",idValue:"",phone:"",organization:"",tutor:"",tutorPhone:"",mobileCode:"",orderId:""},feeInfo:{enrolledEvents:[],totalFee:"",feeInfo:"个人节目为480元/单项, 加项260/项，团体节目（4人元以上）为300元/人，加项零售260/项目",payType:"微信支付"},editable:!1,gender:{1:{id:2,value:"女"},2:{id:1,value:"男"}},radio:"2",showTeacherCode:!1,teacherZone:0,teacherMobileCode:"+86",teacherCodeActions:[{name:"+86",value:0,id:"86"},{name:"+853",value:1,id:"853"},{name:"+852",value:2,id:"852"},{name:"+856",value:3,id:"856"}],result:"",title:""}},mounted:function(){this.init()},methods:{selectTeacherCode:function(){this.showTeacherCode=!0},onTeacherCodeSelect:function(e){console.log(e),this.teacherMobileCode=e.name,this.teacherZone=e.value,this.showTeacherCode=!1},queryInfo:function(e,t,n){var a=this;s.a.get("api/MyOrder/info",{headers:{token:e}}).then(function(e){200===e.data.code?t(e.data.data):n("查询失败，请重试！")}).catch(function(e){console.log(e),n(e.response.data.msg),401===e.response.data.code&&a.$router.replace("/queryInfo")})},changeEditableStatus:function(){var e=this;D.a.confirm({title:"注意",message:"仅有非灰色的信息才能修改！"}).then(function(){e.editable=!0,e.$refs.focus.focus()}).catch(function(){})},validation:function(){var e=this.enrollInfo.orderId,t=this.enrollInfo.name.trim(),n=this.radio,a=this.enrollInfo.organization.trim(),o=this.enrollInfo.tutor.trim(),i=this.enrollInfo.tutorPhone.trim(),l=this.teacherMobileCode;return""===t?(d.a.fail("姓名不能为空！"),!1):""===a?(d.a.fail("教育机构或工作室不能为空！"),!1):""===o?(d.a.fail("导师姓名不能为空！"),!1):""===i?(d.a.fail("导师联系方式不能为空！"),!1):p(i)?{order_id:e,real_name:t,sex:n+"",teacher_organization:a,teacher_mobile_code:l,teacher_mobile:i,teacher:o}:(d.a.fail("导师联系方式错误！"),!1)},saveChange:function(){var e=this;if(this.validation()){var t=this.validation();d.a.loading({mask:!0,message:"加载中...",duration:0}),this.toChange(t,function(t){d.a.clear(),console.log(t),e.editable=!1,e.init(),d.a.success("修改成功")},function(e){d.a.clear(),d.a.fail(e)})}},quitChange:function(){this.editable=!1},toChange:function(e,t,n){var a=this;s.a.post("api/MyOrder/edit",e,{headers:{token:window.sessionStorage.getItem("token")}}).then(function(e){console.log(e),200===e.data.code?t():n("修改失败，请重试！")}).catch(function(e){console.log(e),n(e.response.data.msg),401===e.response.data.code&&a.$router.replace("/queryInfo")})},goEntry:function(){window.sessionStorage.clear(),this.$router.push({name:"Entry"})},init:function(){var e=this,t=window.sessionStorage.getItem("token");t?this.queryInfo(t,function(t){if(console.log(t),!t.order)return e.$router.replace("/step1");switch(t.order.pay_status){case 0:e.result="未支付",e.title="您还未支付，请回到报名填写页面";break;case 1:e.result="报名成功",e.title="报名信息";break;case 2:e.result="支付失败",e.title="支付失败，请查看微信支付详情";break;case 3:e.result="待退款",e.title="您的退款申请正在审核中...";break;case 4:e.result="已退款",e.title="您的退款申请已完成审核"}if(0===t.order.pay_status)return e.$router.replace("/step1");e.enrollInfo.name=t.order.real_name,e.enrollInfo.gender=t.order.sex+""=="1"?"男":"女",e.enrollInfo.zone=t.order.address_name,e.enrollInfo.group=t.order.group_name,e.enrollInfo.idType=["","身份证","户口本","护照","港澳通行证"][t.order.card_type],e.enrollInfo.idValue=t.order.card_number,e.enrollInfo.phone=e.enrollInfo.phone="+"+t.userInfo.mobile_code+" "+t.userInfo.mobile,e.enrollInfo.organization=t.order.teacher_organization,e.enrollInfo.tutor=t.order.teacher,e.enrollInfo.tutorPhone=t.order.teacher_mobile,e.enrollInfo.mobileCode=t.order.mobile_code,e.radio=t.order.sex+"",e.teacherZone={86:0,853:1,852:2,856:3}[t.order.mobile_code],e.teacherMobileCode=e.teacherCodeActions[e.teacherZone].name,e.enrollInfo.orderId=t.order.order_id,t.orderItem.length>0&&(e.feeInfo.enrolledEvents=[],t.orderItem.map(function(t){e.feeInfo.enrolledEvents.push({type:1===t.sort?"主项":"附加项",event:t.project_name,form:t.form_name,price:t.charge+" "+t.settle_currency})}),e.feeInfo.totalFee=t.order.total_amount+" "+t.order.settle_currency,e.feeInfo.time=t.order.pay_date,e.feeInfo.outTradeNum=t.order.out_trade_no)},function(e){d.a.fail(e)}):e.$router.replace("/queryInfo")}},components:{"van-steps":O.a,"van-step":q.a,"van-cell-group":$.a,"van-cell":P.a,"van-button":c.a,"van-field":M.a,"van-radio":V.a,"van-radio-group":R.a,"van-icon":T.a,"van-action-sheet":A.a}},U={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form"},[n("van-steps",{attrs:{active:e.active,"active-color":"#ffcc80"}},[n("van-step",[e._v("上传证件")]),e._v(" "),n("van-step",[e._v("填写信息")]),e._v(" "),n("van-step",[e._v("支付缴费")]),e._v(" "),n("van-step",[e._v(e._s(e.result))])],1),e._v(" "),n("van-cell-group",{staticClass:"round-corner group"},[n("div",{staticClass:"title align-center"},[e._v("\n        "+e._s(e.title)+"\n      ")]),e._v(" "),n("van-field",{ref:"focus",attrs:{readonly:!e.editable,"input-align":"right",label:"参赛选手姓名"},model:{value:e.enrollInfo.name,callback:function(t){e.$set(e.enrollInfo,"name",t)},expression:"enrollInfo.name"}}),e._v(" "),n("van-cell",{attrs:{title:"参赛选手性别"}},[n("div",{attrs:{slot:"default"},slot:"default"},[e.editable?n("van-radio-group",{staticClass:"clear",model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[n("van-radio",{staticClass:"radio-float",attrs:{name:"1","checked-color":"#ffcc80"},scopedSlots:e._u([{key:"icon",fn:function(t){return t.checked?n("svg",{attrs:{t:"1565680314346",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2647",width:"20",height:"20"}},[n("path",{attrs:{d:"M150.1184 150.1184C250.2656 50.0736 370.8928 0 512 0c141.1072 0 261.7344 50.0736 361.8816 150.1184C973.9264 250.2656 1024 370.8928 1024 512c0 141.2096-50.0736 261.8368-150.1184 361.8816C773.7344 973.9264 653.1072 1024 512 1024c-141.1072 0-261.7344-50.0736-361.8816-150.1184C50.0736 773.8368 0 653.2096 0 512 0 370.8928 50.0736 250.2656 150.1184 150.1184zM512 41.8816c-85.2992 0-164.1472 20.8896-236.3392 62.7712C203.4688 146.432 146.432 203.4688 104.6528 275.6608 62.7712 347.9552 41.8816 426.7008 41.8816 512c0 129.6384 45.9776 240.4352 137.8304 332.288C271.5648 936.2432 382.3616 982.1184 512 982.1184c129.6384 0 240.4352-45.8752 332.288-137.8304C936.2432 752.4352 982.1184 641.6384 982.1184 512c0-129.6384-45.9776-240.3328-137.8304-332.288C752.4352 87.7568 641.6384 41.8816 512 41.8816zM512 256c-36.1472 0-70.144 7.0656-102.1952 20.8896C377.856 290.9184 349.4912 309.3504 324.9152 332.288c-22.9376 24.576-41.472 52.9408-55.3984 84.8896S248.6272 483.328 248.6272 519.3728c0 36.1472 6.9632 70.144 20.8896 102.1952s32.4608 60.3136 55.3984 84.8896C349.4912 729.4976 377.856 747.9296 409.8048 761.856 441.856 775.7824 475.8528 782.7456 512 782.7456c36.1472 0 70.144-6.9632 102.1952-20.8896C646.144 747.9296 674.5088 729.4976 699.0848 706.4576c22.9376-24.576 41.472-52.9408 55.3984-84.8896s20.8896-66.048 20.8896-102.1952c0-36.0448-6.9632-70.144-20.8896-102.1952S722.0224 356.9664 699.0848 332.288C674.5088 309.3504 646.144 290.9184 614.1952 276.8896 582.144 263.0656 548.1472 256 512 256z","p-id":"2648"}})]):e._e()}}],null,!0)},[e._v("\n              男\n              ")]),e._v(" "),n("van-radio",{staticClass:"radio-float",attrs:{name:"2","checked-color":"#ffcc80"},scopedSlots:e._u([{key:"icon",fn:function(t){return t.checked?n("svg",{attrs:{t:"1565680314346",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2647",width:"20",height:"20"}},[n("path",{attrs:{d:"M150.1184 150.1184C250.2656 50.0736 370.8928 0 512 0c141.1072 0 261.7344 50.0736 361.8816 150.1184C973.9264 250.2656 1024 370.8928 1024 512c0 141.2096-50.0736 261.8368-150.1184 361.8816C773.7344 973.9264 653.1072 1024 512 1024c-141.1072 0-261.7344-50.0736-361.8816-150.1184C50.0736 773.8368 0 653.2096 0 512 0 370.8928 50.0736 250.2656 150.1184 150.1184zM512 41.8816c-85.2992 0-164.1472 20.8896-236.3392 62.7712C203.4688 146.432 146.432 203.4688 104.6528 275.6608 62.7712 347.9552 41.8816 426.7008 41.8816 512c0 129.6384 45.9776 240.4352 137.8304 332.288C271.5648 936.2432 382.3616 982.1184 512 982.1184c129.6384 0 240.4352-45.8752 332.288-137.8304C936.2432 752.4352 982.1184 641.6384 982.1184 512c0-129.6384-45.9776-240.3328-137.8304-332.288C752.4352 87.7568 641.6384 41.8816 512 41.8816zM512 256c-36.1472 0-70.144 7.0656-102.1952 20.8896C377.856 290.9184 349.4912 309.3504 324.9152 332.288c-22.9376 24.576-41.472 52.9408-55.3984 84.8896S248.6272 483.328 248.6272 519.3728c0 36.1472 6.9632 70.144 20.8896 102.1952s32.4608 60.3136 55.3984 84.8896C349.4912 729.4976 377.856 747.9296 409.8048 761.856 441.856 775.7824 475.8528 782.7456 512 782.7456c36.1472 0 70.144-6.9632 102.1952-20.8896C646.144 747.9296 674.5088 729.4976 699.0848 706.4576c22.9376-24.576 41.472-52.9408 55.3984-84.8896s20.8896-66.048 20.8896-102.1952c0-36.0448-6.9632-70.144-20.8896-102.1952S722.0224 356.9664 699.0848 332.288C674.5088 309.3504 646.144 290.9184 614.1952 276.8896 582.144 263.0656 548.1472 256 512 256z","p-id":"2648"}})]):e._e()}}],null,!0)},[e._v("\n              女\n              ")])],1):n("span",[e._v(e._s(e.enrollInfo.gender))])],1)]),e._v(" "),n("van-cell",{attrs:{title:"参赛地区",value:e.enrollInfo.zone,"value-class":e.editable?"editable":""}}),e._v(" "),n("van-cell",{attrs:{title:"年龄组别",value:e.enrollInfo.group,"value-class":e.editable?"editable":""}}),e._v(" "),n("van-cell",{attrs:{title:"证件类型",value:e.enrollInfo.idType,"value-class":e.editable?"editable":""}}),e._v(" "),n("van-cell",{attrs:{title:"证件号码",value:e.enrollInfo.idValue,"value-class":e.editable?"editable":""}}),e._v(" "),n("van-cell",{attrs:{title:"联系电话",value:e.enrollInfo.phone,"value-class":e.editable?"editable":""}}),e._v(" "),n("van-field",{attrs:{readonly:!e.editable,"input-align":"right",label:"教育机构/工作室"},model:{value:e.enrollInfo.organization,callback:function(t){e.$set(e.enrollInfo,"organization",t)},expression:"enrollInfo.organization"}}),e._v(" "),n("van-field",{attrs:{readonly:!e.editable,"input-align":"right",label:"指导老师"},model:{value:e.enrollInfo.tutor,callback:function(t){e.$set(e.enrollInfo,"tutor",t)},expression:"enrollInfo.tutor"}}),e._v(" "),e.editable?e._e():n("van-cell",{attrs:{title:"指导老师电话",value:e.enrollInfo.tutorPhone}}),e._v(" "),e.editable?n("van-field",{staticStyle:{"line-height":"50px"},attrs:{"input-align":"right",placeholder:"请输入导师手机号","label-width":"150px"},model:{value:e.enrollInfo.tutorPhone,callback:function(t){e.$set(e.enrollInfo,"tutorPhone",t)},expression:"enrollInfo.tutorPhone"}},[n("div",{staticClass:"phone-label",attrs:{slot:"label"},slot:"label"},[n("span",[e._v("导师联系电话")]),e._v(" "),n("span",{staticClass:"flex-two",on:{click:e.selectTeacherCode}},[n("span",[e._v(e._s(e.teacherMobileCode))]),e._v(" "),n("van-icon",{attrs:{name:"arrow-down"}})],1)])]):e._e(),e._v(" "),n("van-action-sheet",{attrs:{actions:e.teacherCodeActions},on:{select:e.onTeacherCodeSelect},model:{value:e.showTeacherCode,callback:function(t){e.showTeacherCode=t},expression:"showTeacherCode"}})],1),e._v(" "),n("van-cell-group",{staticClass:"round-corner group"},[n("div",{staticClass:"title align-center"},[e._v("\n        项目收费\n      ")]),e._v(" "),e._l(e.feeInfo.enrolledEvents,function(t,a){return n("van-cell-group",{key:a,staticClass:"event"},[n("van-cell",{attrs:{title:t.type}}),e._v(" "),n("van-cell",{attrs:{title:"参赛名称",value:t.event,"value-class":e.editable?"editable":""}}),e._v(" "),n("van-cell",{attrs:{title:"参赛形式",value:t.form,"value-class":e.editable?"editable":""}}),e._v(" "),n("van-cell",{attrs:{title:"价钱",value:t.price,"value-class":"item-price"}})],1)}),e._v(" "),n("van-cell",{staticClass:"top-margin",attrs:{title:"费用合计",value:e.feeInfo.totalFee,"title-class":"info-title","value-class":"total-price"}}),e._v(" "),n("van-cell",{attrs:{title:"报名费用详情",label:e.feeInfo.feeInfo,"value-class":e.editable?"editable":""}}),e._v(" "),n("van-cell",{attrs:{title:"支付方式","title-class":"info-title","value-class":e.editable?"info-title editable":"info-title",value:e.feeInfo.payType}}),e._v(" "),n("van-cell",{attrs:{title:"支付时间","title-class":"info-title","value-class":"info-title flex-two",value:e.feeInfo.time}}),e._v(" "),n("van-cell",{attrs:{title:"订单号","title-class":"info-title","value-class":"info-title flex-two",value:e.feeInfo.outTradeNum}})],2),e._v(" "),n("div",{staticClass:"group",staticStyle:{"text-align":"right"}},[n("van-button",{staticClass:"brown-btn",attrs:{round:""},on:{click:e.goEntry}},[e._v("返回入口")]),e._v(" "),e.editable?e._e():n("van-button",{staticClass:"brown-btn",attrs:{round:""},on:{click:e.changeEditableStatus}},[e._v("修改信息")]),e._v(" "),e.editable?n("van-button",{staticClass:"brown-btn",attrs:{round:""},on:{click:e.quitChange}},[e._v("放弃修改")]):e._e(),e._v(" "),e.editable?n("van-button",{staticClass:"brown-btn",attrs:{round:""},on:{click:e.saveChange}},[e._v("保存修改信息")]):e._e()],1)],1)},staticRenderFns:[]};var W=n("VU/8")(B,U,!1,function(e){n("bvUi")},"data-v-7990b3a2",null).exports,Z=(n("jti4"),n("uk7J")),G={data:function(){return{isFirst:!0,idValue:"",index:1,idType:[{},{sign:1,value:"身份证",config:{num:2,value:[{hint:"正面"},{hint:"反面"}]}},{sign:2,value:"户口本",config:{num:1,value:[{hint:"所在页照片"}]}},{sign:3,value:"护照",config:{num:1,value:[{hint:"所在页照片"}]}},{sign:4,value:"港澳通行证",config:{num:2,value:[{hint:"正面"},{hint:"反面"}]}}],fileList:[],show:!1,actions:[{name:"身份证",id:1},{name:"户口本",id:2},{name:"护照",id:3},{name:"港澳通行证",id:4}],loading:!1}},created:function(){window.sessionStorage.getItem("token")||this.$router.replace("/")},mounted:function(){var e=this,t=window.sessionStorage.getItem("token");s.a.defaults.headers={token:t},d.a.loading({mask:!0,message:"加载中...",duration:0}),this.init(t,function(t){if(d.a.clear(),t.order_id)return e.$router.replace("/info"),!1;e.idValue=t.card_number,e.index=t.card_type,t.card_img.length>0?(e.isFirst=!0,t.card_img.map(function(t){e.fileList.push({url:t.thumb})})):(e.isFirst=!1,e.fileList=[])},function(e){d.a.fail(e)})},methods:{selectIdType:function(){console.log("selectIdType"),this.show=!0},beforeRead:function(e){return console.log(e),"image/jpeg"!==e.type&&"image/png"!==e.type?(d.a.fail("请上传 jpg 或 png 格式图片"),!1):!(e.size>3145728)||(d.a.fail("请上传小于3M大小的图片"),!1)},afterRead:function(e){console.log(e),console.log(this.fileList)},onSelect:function(e){console.log(e),this.index!==e.id&&(this.fileList=[],this.index=e.id),this.show=!1},validation:function(){var e,t={};return t.idType=this.idType[this.index],t.idValue=this.idValue.trim(),t.idFile=this.fileList,""===t.idValue?(d.a.fail("证件号码不能为空！"),!1):(e=t.idValue,/^[1-9][0-9]{5}([1][9][0-9]{2}|[2][0][0|1][0-9])([0][1-9]|[1][0|1|2])([0][1-9]|[1|2][0-9]|[3][0|1])[0-9]{3}([0-9]|[X])$/.test(e)||1!==this.index?0===t.idFile.length?(d.a.fail("请上传证件照片！"),!1):1===t.idFile.length&&t.idType.config.num>1?(d.a.fail("请上传证件反面照片！"),!1):t:(d.a.fail("证件号码错误！"),!1))},onSubmit:function(){if(this.validation()){console.log(this.validation());var e=this,t=this.validation(),n=new FormData;n.append("card_type",t.idType.sign),n.append("card_number",t.idValue),t.idFile.map(function(e,t){e.url||e.file&&n.append("file"+(t+1),e.file)});d.a.loading({mask:!0,message:"上传中...",duration:0}),this.uploadCard(n,{headers:{"Content-Type":"multipart/form-data"}},function(){console.log(e.fileList),d.a.clear(),window.sessionStorage.setItem("step1Data","true"),e.$router.push({name:"Step2"})},function(e){d.a.clear(),d.a.fail(e)})}},uploadCard:function(e,t,n,a){s.a.post("api/MatchOrder/uploadCard",e,t).then(function(e){console.log(e),200===e.data.code?n(e.data.data):a("上传失败，请重试！")}).catch(function(e){console.log(e.response.data.msg),a(e.response.data.msg)})},init:function(e,t,n){s.a.get("api/MatchOrder/cardInfo",{headers:{token:e}}).then(function(e){console.log(e),200===e.data.code?t(e.data.data):n()}).catch(function(e){d.a.clear(),console.log(e),n(e.response.data.msg)})}},components:{"van-steps":O.a,"van-step":q.a,"van-cell":P.a,"van-cell-group":$.a,"van-field":M.a,"van-icon":T.a,"van-uploader":Z.a,"van-button":c.a,"van-action-sheet":A.a}},H={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"step1"},[n("van-cell-group",{staticClass:"round-corner group"},[n("div",{staticClass:"title align-center"},[e._v("\n      上传证件信息\n    ")]),e._v(" "),n("van-cell",{attrs:{title:"证件类型",value:e.idType[e.index].value,isLink:""},on:{click:e.selectIdType}}),e._v(" "),n("van-action-sheet",{attrs:{actions:e.actions},on:{select:e.onSelect},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}}),e._v(" "),n("van-field",{attrs:{"input-align":"right",clearable:"",label:"证件号码",placeholder:"请输入证件号码"},model:{value:e.idValue,callback:function(t){e.idValue=t},expression:"idValue"}}),e._v(" "),n("van-cell",{attrs:{title:"请上传证件照片(照片需清晰)"}},[n("div",{attrs:{slot:"label"},slot:"label"},[n("van-uploader",{staticStyle:{"margin-right":"15px"},attrs:{"before-read":e.beforeRead,"after-read":e.afterRead,multiple:"","upload-text":e.idType[e.index].config.value[e.idType[e.index].config.num>1?e.fileList.length>1?1:e.fileList.length:0].hint,"max-count":e.idType[e.index].config.num>1?2:1},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1)])],1),e._v(" "),n("van-button",{staticClass:"submit-btn one",attrs:{round:"",size:"large",type:"default",loading:e.loading},on:{click:e.onSubmit}},[e._v("\n    下一步\n  ")])],1)},staticRenderFns:[]};var J=n("VU/8")(G,H,!1,function(e){n("pUlv")},"data-v-8b64fe08",null).exports,N={data:function(){return{active:0}},mounted:function(){_(this)},methods:{},components:{"van-steps":O.a,"van-step":q.a,"step-one":J}},Q={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form"},[n("canvas",{ref:"canvas",staticClass:"canvas"}),e._v(" "),n("div",[n("van-steps",{attrs:{active:e.active,"active-color":"#ffcc80"}},[n("van-step",[e._v("上传证件")]),e._v(" "),n("van-step",[e._v("填写信息")]),e._v(" "),n("van-step",[e._v("支付缴费")]),e._v(" "),n("van-step",[e._v("报名结果")])],1),e._v(" "),n("step-one")],1)])},staticRenderFns:[]};var Y=n("VU/8")(N,Q,!1,function(e){n("PVvA")},"data-v-58041c38",null).exports,X=n("Dd8w"),K=n.n(X),ee={props:{eventConfig:{type:Object,default:function(){return{}}},index:{type:Number,default:0},selectEvent:{type:Function,default:null},onEventSelect:{type:Function,default:null},selectForm:{type:Function,default:null},onFormSelect:{type:Function,default:null},onDelete:{type:Function,default:null}},methods:{childOnDelete:function(){this.onDelete&&this.onDelete(this.index)},childSelectEvent:function(){this.selectEvent&&this.selectEvent(this.index)},childOnEventSelect:function(e){this.onEventSelect&&this.onEventSelect(e,this.index)},childSelectForm:function(){this.selectForm&&this.selectForm(this.index)},childOnFormSelect:function(e){this.onFormSelect&&this.onFormSelect(e,this.index)}},components:{"van-cell-group":$.a,"van-cell":P.a,"van-action-sheet":A.a,"van-button":c.a}},te={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-cell-group",{staticClass:"event"},[n("van-cell",{attrs:{title:e.eventConfig.title}},[e.eventConfig.isMain?e._e():n("div",{attrs:{slot:"default"},slot:"default"},[n("van-button",{staticClass:"radius",attrs:{size:"small",type:"danger"},on:{click:e.childOnDelete}},[e._v("删除")])],1)]),e._v(" "),n("van-cell",{attrs:{title:"参赛名称",required:"",value:e.eventConfig.event[e.eventConfig.eventIndex]?e.eventConfig.event[e.eventConfig.eventIndex].value:"",isLink:""},on:{click:e.childSelectEvent}}),e._v(" "),n("van-action-sheet",{attrs:{actions:e.eventConfig.eventActions},on:{select:e.childOnEventSelect},model:{value:e.eventConfig.eventShow,callback:function(t){e.$set(e.eventConfig,"eventShow",t)},expression:"eventConfig.eventShow"}}),e._v(" "),n("van-cell",{attrs:{title:"参赛形式",required:"",value:e.eventConfig.form[e.eventConfig.formIndex]?e.eventConfig.form[e.eventConfig.formIndex].value:"",isLink:""},on:{click:e.childSelectForm}}),e._v(" "),n("van-action-sheet",{attrs:{actions:e.eventConfig.formActions},on:{select:e.childOnFormSelect},model:{value:e.eventConfig.formShow,callback:function(t){e.$set(e.eventConfig,"formShow",t)},expression:"eventConfig.formShow"}})],1)},staticRenderFns:[]};var ne=n("VU/8")(ee,te,!1,function(e){n("5ZkD")},"data-v-ea92f7b6",null).exports,ae={data:function(){return{name:"",gender:{1:{id:2,value:"女"},2:{id:1,value:"男"}},radio:"2",areaIndex:1,area:[],areaShow:!1,areaActions:[],ageIndex:1,age:[],ageShow:!1,ageActions:[],listAmount:1,listInfo:[{title:"主项",isMain:!0,eventIndex:1,event:[],eventShow:!1,eventActions:[],formIndex:1,form:[],formShow:!1,formActions:[]}],mobileCode:"",message:"",phone:"",showTeacherCode:!1,teacherZone:0,teacherMobileCode:"+86",teacherCodeActions:[{name:"+86",value:0,id:"86"},{name:"+853",value:1,id:"853"},{name:"+852",value:2,id:"852"},{name:"+856",value:3,id:"856"}],organization:"",tutor:"",tutorPhone:"",loading:!1}},created:function(){window.sessionStorage.getItem("token")?window.sessionStorage.getItem("step1Data")||this.$router.replace("/step1"):this.$router.replace("/")},mounted:function(){var e=this,t=window.sessionStorage.getItem("token");s.a.defaults.headers={token:t},d.a.loading({mask:!0,message:"加载中...",duration:0}),this.init(t,function(t){if(d.a.clear(),t.order&&t.order.pay_status&&1===t.order.pay_status)return e.$router.replace("/info");e.mobileCode="+"+t.userInfo.mobile_code,e.phone=t.userInfo.mobile,t.order&&t.orderItem.length>0?(console.log("第二次"),e.initConfig(t,function(){e.getAddress(function(){e.areaIndex=t.order.address_id}),e.getAgeGroup(function(){e.ageIndex=t.order.group_id}),e.listAmount=t.orderItem.length,t.orderItem.length>0&&e.getEvent(e.areaIndex,e.ageIndex,null,function(n){console.log(n);var a=[],o=[],i=[{}];n.map(function(e,t){o.push({name:e.project_name,id:t+1,projectId:e.project_id,formList:e.formList}),i.push({value:e.project_name,id:t+1,projectId:e.project_id,formList:e.formList})}),t.orderItem.map(function(e,t){console.log(e);var n=1,l=1;i.map(function(t,a){t.projectId&&e.project_id===t.projectId&&(n=a)});var s=[],r=[{}];i[n].formList.map(function(t,n){console.log(t,t.form_id,e.form_id),t.form_id&&e.form_id===t.form_id&&(l=n+1)}),i[n].formList.map(function(e,t){s.push({name:e.form_name,id:t+1,formId:e.form_id,config:e}),r.push({value:e.form_name,id:t+1,formId:e.form_id,config:e})}),a.push({title:1===e.sort?"主项":"附加项",isMain:1===e.sort,eventShow:!1,eventActions:o,event:i,eventIndex:n,formIndex:l,form:r,formActions:s})}),e.listInfo=[],a.map(function(t){e.listInfo.push({title:t.title,isMain:t.isMain,eventIndex:t.eventIndex,event:t.event,eventShow:t.eventShow,eventActions:t.eventActions,formIndex:t.formIndex,form:t.form,formShow:t.formShow,formActions:t.formActions})})})})):(console.log("第一次"),e.getAddress(e.getEvent),e.getAgeGroup(e.getEvent))},function(e){d.a.fail(e)})},methods:{selectTeacherCode:function(){this.showTeacherCode=!0},onTeacherCodeSelect:function(e){console.log(e),this.teacherMobileCode=e.name,this.teacherZone=e.value,this.showTeacherCode=!1},selectArea:function(){console.log("selectArea"),this.areaShow=!0},selectAge:function(){console.log("selectAge"),this.ageShow=!0},onAreaSelect:function(e){console.log(e),this.areaShow=!1,e.id!==this.area[this.areaIndex].id&&(this.listInfo.splice(1),this.areaIndex=e.id,this.getEvent(e.id,this.age[this.ageIndex].id,0))},onAgeSelect:function(e){console.log(e),this.ageShow=!1,e.id!==this.age[this.ageIndex].id&&(this.listInfo.splice(1),this.ageIndex=e.id,this.getEvent(this.area[this.areaIndex].id,e.id,0))},selectEvent:function(e){console.log(e),console.log(this.listInfo[e]),this.listInfo[e].eventShow=!0},onEventSelect:function(e,t){console.log(e),e.id!==this.listInfo[t].eventIndex&&(console.log("change"),this.listInfo[t].eventIndex=e.id,this.configForm(e,t)),this.listInfo[t].eventShow=!1},selectForm:function(e){console.log("select Form"),this.listInfo[e].formShow=!0},onFormSelect:function(e,t){this.formShow=!1,console.log(e),this.listInfo[t].formIndex=e.id,this.listInfo[t].formShow=!1},onDelete:function(e){console.log(e),this.listInfo.splice(e,1)},onAddEvent:function(){console.log("Add"),this.listInfo.length<3?this.listInfo=this.listInfo.concat({title:"附加项",isMain:!1,eventIndex:1,event:this.listInfo[0].event,eventShow:!1,eventActions:this.listInfo[0].eventActions,formIndex:1,form:this.listInfo[0].form,formShow:!1,formActions:this.listInfo[0].formActions}):d.a.fail("每个团体或个人最多仅能参加3个项目")},validation:function(){console.log("validation");var e=this.name.trim(),t=this.message.trim(),n=this.organization.trim(),a=this.tutor.trim(),o=this.tutorPhone.trim(),i=[];if(this.listInfo.map(function(e,t){e.event.length>0&&i.push({project_id:e.event[e.eventIndex].projectId,project_name:e.event[e.eventIndex].value,form_id:e.form[e.formIndex].formId,form_name:e.form[e.formIndex].value,sort:t+1,charge:e.isMain?e.form[e.formIndex].config.main_charge:e.form[e.formIndex].config.add_charge,settle_currency:e.form[e.formIndex].config.settle_currency})}),console.log(i),i.length<1)return d.a.fail("暂时无可报名的项目！"),!1;if(i.length>1)for(var l=0;l<i.length-1;l++)for(var s=1;s<i.length;s++)if(i[l].project_id===i[s].project_id&&i[l].form_id===i[s].form_id)return d.a.fail("不能报名两个完全相同的项目"),!1;return""===e?(d.a.fail("请输入您的姓名！"),!1):""===n?(d.a.fail("请输入您的所属机构或工作室！"),!1):""===a?(d.a.fail("请输入您的指导老师姓名！"),!1):""===o?(d.a.fail("请输入您的指导老师联系方式！"),!1):p(o)?{real_name:e,sex:this.radio,address_id:this.area[this.areaIndex].addressId,address_name:this.area[this.areaIndex].value,group_id:this.age[this.ageIndex].groupId,group_name:this.age[this.ageIndex].value,remark:t,teacher_organization:n,teacher:a,teacher_mobile_code:this.teacherMobileCode,teacher_mobile:o,orderItem:i}:(d.a.fail("您输入的指导老师联系方式有误！"),!1)},goBack:function(){this.$router.replace("/step1")},onSubmit:function(){if(this.validation()){var e=this.validation(),t=K()({},e);console.log(t);var n=this;d.a.loading({mask:!0,message:"资料上传中...",duration:0}),this.toEnroll(t,function(e){d.a.clear(),console.log(e.data.data),window.sessionStorage.setItem("step2Data","true"),n.$router.push({name:"Step3"})},function(e){d.a.clear(),d.a.fail(e)})}},getAddress:function(e){var t=this;s.a.get("api/MatchAddress/select").then(function(n){200===n.data.code?t.configArea(n.data.data,e):d.a.fail("地址信息获取失败")}).catch(function(e){console.log(e),d.a.fail("地址信息获取失败")})},getAgeGroup:function(e){var t=this;s.a.get("api/MatchGroup/select").then(function(n){200===n.data.code?t.configAgeGroup(n.data.data,e):d.a.fail("年龄分组获取失败")}).catch(function(e){console.log(e),d.a.fail("年龄分组获取失败")})},getEvent:function(e,t,n,a){var o=this;s.a.post("api/MatchProject/select",{address_id:e,group_id:t}).then(function(e){200===e.data.code?e.data.data.length>0?o.configEvent(e.data.data,n,a):d.a.fail("该地区还没有可参加的项目！"):d.a.fail("获取参赛项目失败")}).catch(function(e){console.log(e),d.a.fail("获取参赛项目失败")})},configArea:function(e,t){var n=[],a=[{}];e.map(function(e,t){n.push({name:e.address_name,id:t+1,addressId:e.address_id}),a.push({value:e.address_name,id:t+1,addressId:e.address_id})}),this.areaActions=n,this.area=a,t&&this.area[this.areaIndex]&&this.age[this.ageIndex]&&t(this.area[this.areaIndex].addressId,this.age[this.ageIndex].groupId,0)},configAgeGroup:function(e,t){var n=[],a=[{}];e.map(function(e,t){n.push({name:e.group_name+e.min_age+"-"+e.max_age+"岁",id:t+1,groupId:e.group_id}),a.push({value:e.group_name+e.min_age+"-"+e.max_age+"岁",id:t+1,groupId:e.group_id})}),this.ageActions=n,this.age=a,t&&this.area[this.areaIndex]&&this.age[this.ageIndex]&&t(this.area[this.areaIndex].addressId,this.age[this.ageIndex].groupId,0)},configEvent:function(e,t,n){if(console.log(e),n)n(e);else{var a=[],o=[{}];e.map(function(e,t){a.push({name:e.project_name,id:t+1,projectId:e.project_id,formList:e.formList}),o.push({value:e.project_name,id:t+1,projectId:e.project_id,formList:e.formList})}),this.listInfo[t].eventActions=a,this.listInfo[t].event=o,this.configForm(this.listInfo[t].event[this.listInfo[t].eventIndex],t)}},configForm:function(e,t){var n=[],a=[{}];e.formList.map(function(e,t){n.push({name:e.form_name,id:t+1,formId:e.form_id,config:e}),a.push({value:e.form_name,id:t+1,formId:e.form_id,config:e})}),this.listInfo[t].formActions=n,this.listInfo[t].form=a},toEnroll:function(e,t,n){s.a.post("api/MatchOrder/insert",e).then(function(e){console.log(e),200===e.data.code?t(e):n()}).catch(function(e){n(e.response.data.msg)})},init:function(e,t,n){s.a.get("api/MyOrder/info",{headers:{token:e}}).then(function(e){console.log(e),200===e.data.code?t(e.data.data):n()}).catch(function(e){d.a.clear(),console.log(e),n(e.response.data.msg)})},initConfig:function(e,t){console.log(e);this.name=e.order.real_name,this.radio=e.order.sex+"",this.message=e.order.remark,this.teacherZone={86:0,853:1,852:2,856:3}[e.order.teacher_mobile_code+""],this.teacherMobileCode="+"+e.order.teacher_mobile_code,this.organization=e.order.teacher_organization,this.tutor=e.order.teacher,this.tutorPhone=e.order.teacher_mobile,t()}},components:{"van-steps":O.a,"van-step":q.a,"van-cell":P.a,"van-cell-group":$.a,"van-field":M.a,"van-icon":T.a,"van-uploader":Z.a,"van-button":c.a,"van-action-sheet":A.a,"van-sports-event":ne,"van-radio-group":R.a,"van-radio":V.a}},oe={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"step1"},[n("van-cell-group",{staticClass:"round-corner group"},[n("div",{staticClass:"title align-center"},[e._v("\n      填报报名信息\n    ")]),e._v(" "),n("van-field",{attrs:{"input-align":"right",clearable:"",required:"",label:"参赛选手姓名",placeholder:"请输入您的姓名"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),e._v(" "),n("van-cell",{attrs:{title:"参赛选手性别",required:""}},[n("div",{attrs:{slot:"default"},slot:"default"},[n("van-radio-group",{staticClass:"clear",model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[n("van-radio",{staticClass:"radio-float",attrs:{name:"1","checked-color":"#ffcc80"},scopedSlots:e._u([{key:"icon",fn:function(t){return t.checked?n("svg",{attrs:{t:"1565680314346",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2647",width:"20",height:"20"}},[n("path",{attrs:{d:"M150.1184 150.1184C250.2656 50.0736 370.8928 0 512 0c141.1072 0 261.7344 50.0736 361.8816 150.1184C973.9264 250.2656 1024 370.8928 1024 512c0 141.2096-50.0736 261.8368-150.1184 361.8816C773.7344 973.9264 653.1072 1024 512 1024c-141.1072 0-261.7344-50.0736-361.8816-150.1184C50.0736 773.8368 0 653.2096 0 512 0 370.8928 50.0736 250.2656 150.1184 150.1184zM512 41.8816c-85.2992 0-164.1472 20.8896-236.3392 62.7712C203.4688 146.432 146.432 203.4688 104.6528 275.6608 62.7712 347.9552 41.8816 426.7008 41.8816 512c0 129.6384 45.9776 240.4352 137.8304 332.288C271.5648 936.2432 382.3616 982.1184 512 982.1184c129.6384 0 240.4352-45.8752 332.288-137.8304C936.2432 752.4352 982.1184 641.6384 982.1184 512c0-129.6384-45.9776-240.3328-137.8304-332.288C752.4352 87.7568 641.6384 41.8816 512 41.8816zM512 256c-36.1472 0-70.144 7.0656-102.1952 20.8896C377.856 290.9184 349.4912 309.3504 324.9152 332.288c-22.9376 24.576-41.472 52.9408-55.3984 84.8896S248.6272 483.328 248.6272 519.3728c0 36.1472 6.9632 70.144 20.8896 102.1952s32.4608 60.3136 55.3984 84.8896C349.4912 729.4976 377.856 747.9296 409.8048 761.856 441.856 775.7824 475.8528 782.7456 512 782.7456c36.1472 0 70.144-6.9632 102.1952-20.8896C646.144 747.9296 674.5088 729.4976 699.0848 706.4576c22.9376-24.576 41.472-52.9408 55.3984-84.8896s20.8896-66.048 20.8896-102.1952c0-36.0448-6.9632-70.144-20.8896-102.1952S722.0224 356.9664 699.0848 332.288C674.5088 309.3504 646.144 290.9184 614.1952 276.8896 582.144 263.0656 548.1472 256 512 256z","p-id":"2648"}})]):e._e()}}],null,!0)},[e._v("\n            男\n            ")]),e._v(" "),n("van-radio",{staticClass:"radio-float",attrs:{name:"2","checked-color":"#ffcc80"},scopedSlots:e._u([{key:"icon",fn:function(t){return t.checked?n("svg",{attrs:{t:"1565680314346",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2647",width:"20",height:"20"}},[n("path",{attrs:{d:"M150.1184 150.1184C250.2656 50.0736 370.8928 0 512 0c141.1072 0 261.7344 50.0736 361.8816 150.1184C973.9264 250.2656 1024 370.8928 1024 512c0 141.2096-50.0736 261.8368-150.1184 361.8816C773.7344 973.9264 653.1072 1024 512 1024c-141.1072 0-261.7344-50.0736-361.8816-150.1184C50.0736 773.8368 0 653.2096 0 512 0 370.8928 50.0736 250.2656 150.1184 150.1184zM512 41.8816c-85.2992 0-164.1472 20.8896-236.3392 62.7712C203.4688 146.432 146.432 203.4688 104.6528 275.6608 62.7712 347.9552 41.8816 426.7008 41.8816 512c0 129.6384 45.9776 240.4352 137.8304 332.288C271.5648 936.2432 382.3616 982.1184 512 982.1184c129.6384 0 240.4352-45.8752 332.288-137.8304C936.2432 752.4352 982.1184 641.6384 982.1184 512c0-129.6384-45.9776-240.3328-137.8304-332.288C752.4352 87.7568 641.6384 41.8816 512 41.8816zM512 256c-36.1472 0-70.144 7.0656-102.1952 20.8896C377.856 290.9184 349.4912 309.3504 324.9152 332.288c-22.9376 24.576-41.472 52.9408-55.3984 84.8896S248.6272 483.328 248.6272 519.3728c0 36.1472 6.9632 70.144 20.8896 102.1952s32.4608 60.3136 55.3984 84.8896C349.4912 729.4976 377.856 747.9296 409.8048 761.856 441.856 775.7824 475.8528 782.7456 512 782.7456c36.1472 0 70.144-6.9632 102.1952-20.8896C646.144 747.9296 674.5088 729.4976 699.0848 706.4576c22.9376-24.576 41.472-52.9408 55.3984-84.8896s20.8896-66.048 20.8896-102.1952c0-36.0448-6.9632-70.144-20.8896-102.1952S722.0224 356.9664 699.0848 332.288C674.5088 309.3504 646.144 290.9184 614.1952 276.8896 582.144 263.0656 548.1472 256 512 256z","p-id":"2648"}})]):e._e()}}],null,!0)},[e._v("\n            女\n            ")])],1)],1)]),e._v(" "),n("van-cell",{attrs:{title:"参赛地区",value:e.area[e.areaIndex]?e.area[e.areaIndex].value:"",required:"",isLink:""},on:{click:e.selectArea}}),e._v(" "),n("van-action-sheet",{attrs:{actions:e.areaActions},on:{select:e.onAreaSelect},model:{value:e.areaShow,callback:function(t){e.areaShow=t},expression:"areaShow"}}),e._v(" "),n("van-cell",{attrs:{title:"年龄组别",required:"",value:e.age[e.ageIndex]?e.age[e.ageIndex].value:"",isLink:""},on:{click:e.selectAge}}),e._v(" "),n("van-action-sheet",{attrs:{actions:e.ageActions},on:{select:e.onAgeSelect},model:{value:e.ageShow,callback:function(t){e.ageShow=t},expression:"ageShow"}}),e._v(" "),n("van-field",{attrs:{"input-align":"right",clearable:"",required:"",readonly:"",label:"参赛项目",placeholder:"每人只能参加三项"}}),e._v(" "),n("div",{staticClass:"events-container"},[e._l(e.listInfo,function(t,a){return n("van-sports-event",{key:a,attrs:{eventConfig:t,index:a,selectEvent:e.selectEvent,onEventSelect:e.onEventSelect,selectForm:e.selectForm,onFormSelect:e.onFormSelect,onDelete:e.onDelete}})}),e._v(" "),n("div",{staticClass:"center"},[n("van-button",{staticClass:"radius brown-btn",attrs:{type:"danger",size:"middle"},on:{click:e.onAddEvent}},[e._v("增加项目")])],1)],2),e._v(" "),n("van-field",{attrs:{label:"备注",type:"textarea",placeholder:"请输入备注信息",rows:"1",autosize:"","input-align":"right"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),e._v(" "),n("van-field",{staticStyle:{"line-height":"50px"},attrs:{required:"",readonly:"","input-align":"right",placeholder:"请输入手机号"},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}},[n("div",{staticClass:"phone-label",attrs:{slot:"label"},slot:"label"},[n("span",[e._v("联系电话")]),e._v(" "),n("span",{staticClass:"flex-two"},[n("span",[e._v(e._s(e.mobileCode))])])])]),e._v(" "),n("van-field",{attrs:{label:"教育机构/工作室",type:"textarea",placeholder:"请输入机构或工作室名称",rows:"1",required:"",autosize:"","input-align":"right"},model:{value:e.organization,callback:function(t){e.organization=t},expression:"organization"}}),e._v(" "),n("van-field",{attrs:{label:"指导老师",type:"textarea",placeholder:"请输入指导老师名",rows:"1",autosize:"",required:"","input-align":"right"},model:{value:e.tutor,callback:function(t){e.tutor=t},expression:"tutor"}}),e._v(" "),n("van-field",{staticStyle:{"line-height":"50px"},attrs:{required:"","input-align":"right",placeholder:"请输入导师手机号","label-width":"150px"},model:{value:e.tutorPhone,callback:function(t){e.tutorPhone=t},expression:"tutorPhone"}},[n("div",{staticClass:"phone-label",attrs:{slot:"label"},slot:"label"},[n("span",[e._v("导师联系电话")]),e._v(" "),n("span",{staticClass:"flex-two",on:{click:e.selectTeacherCode}},[n("span",[e._v(e._s(e.teacherMobileCode))]),e._v(" "),n("van-icon",{attrs:{name:"arrow-down"}})],1)])]),e._v(" "),n("van-action-sheet",{attrs:{actions:e.teacherCodeActions},on:{select:e.onTeacherCodeSelect},model:{value:e.showTeacherCode,callback:function(t){e.showTeacherCode=t},expression:"showTeacherCode"}})],1),e._v(" "),n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("van-button",{staticClass:"submit-btn",attrs:{round:"",type:"default",loading:e.loading},on:{click:e.goBack}},[e._v("\n      上一步\n    ")]),e._v(" "),n("van-button",{staticClass:"submit-btn",attrs:{round:"",type:"default",loading:e.loading},on:{click:e.onSubmit}},[e._v("\n      下一步\n    ")])],1)],1)},staticRenderFns:[]};var ie=n("VU/8")(ae,oe,!1,function(e){n("pbW4")},"data-v-5646a26d",null).exports,le={data:function(){return{active:1}},methods:{},components:{"van-steps":O.a,"van-step":q.a,"step-two":ie}},se={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form"},[n("van-steps",{attrs:{active:e.active,"active-color":"#ffcc80"}},[n("van-step",[e._v("上传证件")]),e._v(" "),n("van-step",[e._v("填写信息")]),e._v(" "),n("van-step",[e._v("支付缴费")]),e._v(" "),n("van-step",[e._v("报名结果")])],1),e._v(" "),n("step-two")],1)},staticRenderFns:[]};var re=n("VU/8")(le,se,!1,function(e){n("HY0d")},"data-v-e58af13c",null).exports,ce=(n("cZ0s"),n("fIxc")),de={data:function(){return{enrollInfo:{name:"",gender:"",zone:"",group:"",idType:"",idValue:"",phone:"",organization:"",tutor:"",tutorPhone:"",orderId:""},feeInfo:{enrolledEvents:[],totalFee:"",feeInfo:"个人节目为480元/单项，加项另收260/项，团体节目（4人以上）为300元/人，加项另收260/项目。",payType:"微信支付"},radio:"1",checked:!1}},created:function(){window.sessionStorage.getItem("token")?window.sessionStorage.getItem("step2Data")?window.sessionStorage.getItem("step1Data")||this.$router.replace("/step1"):this.$router.replace("/step2"):this.$router.replace("/")},mounted:function(){var e=window.sessionStorage.getItem("token");s.a.defaults.headers={token:e};var t=this;d.a.loading({mask:!0,message:"加载中...",duration:0}),this.init(e,function(e){if(1===e.order.pay_status)return t.$router.replace("/info");console.log(e),t.enrollInfo.name=e.order.real_name,t.enrollInfo.gender=e.order.sex+""=="1"?"男":"女",t.enrollInfo.zone=e.order.address_name,t.enrollInfo.group=e.order.group_name,t.enrollInfo.idType=["","身份证","户口本","护照","港澳通行证"][e.order.card_type],t.enrollInfo.idValue=e.order.card_number,t.enrollInfo.phone="+"+e.userInfo.mobile_code+" "+e.userInfo.mobile,t.enrollInfo.organization=e.order.teacher_organization,t.enrollInfo.tutor=e.order.teacher,t.enrollInfo.tutorPhone=e.order.teacher_mobile,t.enrollInfo.orderId=e.order.order_id,e.orderItem.length>0&&(e.orderItem.map(function(e){t.feeInfo.enrolledEvents.push({type:1===e.sort?"主项":"附加项",event:e.project_name,form:e.form_name,price:e.charge+" "+e.settle_currency})}),t.feeInfo.totalFee=e.order.total_amount+" "+e.order.settle_currency)},function(e){d.a.fail(e)})},methods:{goBack:function(){this.$router.replace("/step2")},onSubmit:function(){if(console.log("submit"),!this.checked)return d.a.fail("请阅读并确认已查看注意事项"),!1;var e=h(),t=e?{openId:window.sessionStorage.getItem("openId"),order_id:this.enrollInfo.orderId,payType:"wechat",payScene:"js"}:{order_id:this.enrollInfo.orderId,payType:"wechat",payScene:"h5"};e?(alert("wx"),function(e,t){s.a.post("api/MatchOrder/pay",e).then(function(e){"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",f.onBridgeReady,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",f.onBridgeReady),document.attachEvent("onWeixinJSBridgeReady",f.onBridgeReady)):t(e.data)}).catch(function(e){alert(v()(e)),d.a.fail(e.response.data.msg)})}(t,m)):function(e,t,n){console.log("H5"),s.a.post("api/MatchOrder/pay",e).then(function(e){if(200===e.data.code){var t=window.location.protocol+"//"+window.location.host+"/step4",n=e.data.data.mweb_url+"&redirect_url="+encodeURIComponent(t),a=document.createElement("FORM");document.body.appendChild(a),a.setAttribute("method","POST"),a.setAttribute("action",n),a.submit()}}).catch(function(e){alert(v()(e)),d.a.fail(e.response.data.msg)})}(t)},init:function(e,t,n){s.a.get("api/MyOrder/info",{headers:{token:e}}).then(function(e){console.log(e),200===e.data.code?(d.a.clear(),t(e.data.data)):(d.a.clear(),n("获取信息失败， 请重试"))}).catch(function(e){console.log(e),d.a.clear(),n(e.response.data.msg)})}},components:{"van-button":c.a,"van-cell":P.a,"van-cell-group":$.a,"van-radio-group":R.a,"van-radio":V.a,"van-checkbox":ce.a}},ue={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pay"},[n("van-cell-group",{staticClass:"round-corner group"},[n("div",{staticClass:"title align-center"},[e._v("\n      缴费\n    ")]),e._v(" "),n("van-cell",{attrs:{title:"参赛选手姓名",value:e.enrollInfo.name}}),e._v(" "),n("van-cell",{attrs:{title:"参赛选手性别",value:e.enrollInfo.gender}}),e._v(" "),n("van-cell",{attrs:{title:"参赛地区",value:e.enrollInfo.zone}}),e._v(" "),n("van-cell",{attrs:{title:"年龄组别",value:e.enrollInfo.group}}),e._v(" "),n("van-cell",{attrs:{title:"证件类型",value:e.enrollInfo.idType}}),e._v(" "),n("van-cell",{attrs:{title:"证件号码",value:e.enrollInfo.idValue}}),e._v(" "),n("van-cell",{attrs:{title:"联系电话",value:e.enrollInfo.phone}}),e._v(" "),n("van-cell",{attrs:{title:"教育机构/工作室",value:e.enrollInfo.organization}}),e._v(" "),n("van-cell",{attrs:{title:"指导老师",value:e.enrollInfo.tutor}}),e._v(" "),n("van-cell",{attrs:{title:"指导老师电话",value:e.enrollInfo.tutorPhone}})],1),e._v(" "),n("van-cell-group",{staticClass:"round-corner group"},[n("div",{staticClass:"title align-center"},[e._v("\n      项目收费\n    ")]),e._v(" "),e._l(e.feeInfo.enrolledEvents,function(t,a){return n("van-cell-group",{key:a,staticClass:"event"},[n("van-cell",{attrs:{title:t.type}}),e._v(" "),n("van-cell",{attrs:{title:"参赛名称",value:t.event}}),e._v(" "),n("van-cell",{attrs:{title:"参赛形式",value:t.form}}),e._v(" "),n("van-cell",{attrs:{title:"价钱",value:t.price,"value-class":"item-price"}})],1)}),e._v(" "),n("van-cell",{staticClass:"top-margin",attrs:{title:"费用合计",value:e.feeInfo.totalFee,"title-class":"info-title","value-class":"total-price"}}),e._v(" "),n("van-cell",{attrs:{title:"报名费用详情",label:e.feeInfo.feeInfo}}),e._v(" "),n("van-cell",{attrs:{title:"支付方式","title-class":"info-title"}}),e._v(" "),n("van-cell",{attrs:{center:""}},[n("svg",{attrs:{slot:"icon",t:"1565774382529",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2114",width:"48",height:"48"},slot:"icon"},[n("path",{attrs:{d:"M236.24 323.769c0 24.005 19.32 43.325 43.325 43.325s43.326-19.32 43.326-43.325c0-24.005-19.321-43.325-43.326-43.325-24.004 0-43.325 19.32-43.325 43.325z m336.064 223.067c0 18.735 15.223 33.958 33.958 33.958s33.958-15.223 33.958-33.958-15.223-33.958-33.958-33.958-33.958 15.223-33.958 33.958zM456.38 323.769c0 24.005 19.32 43.325 43.325 43.325 24.005 0 43.325-19.32 43.325-43.325 0-24.005-19.32-43.325-43.325-43.325-24.005 0-43.325 19.32-43.325 43.325z","p-id":"2115",fill:"#388E3C"}}),n("path",{attrs:{d:"M858.017 0H165.983C74.648 0 0.293 74.356 0.293 166.276v690.863c0 91.92 74.355 166.276 165.69 166.276h692.034c91.335 0 165.69-74.356 165.69-166.276V166.276C1023.707 74.94 949.352 0 858.017 0zM384.366 686.18c-38.642 0-69.672-8.197-108.899-15.808L167.154 724.82l31.03-93.09C120.316 577.28 74.063 507.022 74.063 422.128c0-147.54 139.929-264.05 310.303-264.05 152.81 0 286.298 93.09 313.23 217.798a255.341 255.341 0 0 0-29.859-1.757c-147.54 0-264.05 110.07-264.05 245.315 0 22.834 3.513 44.496 9.367 64.988-9.367 1.171-18.735 1.757-28.688 1.757z m457.843 108.313l23.42 77.283-84.895-46.838c-31.03 7.61-62.06 15.808-93.09 15.808-147.541 0-264.051-100.703-264.051-225.41 0-124.12 116.51-225.408 264.05-225.408 139.344 0 263.465 101.288 263.465 225.409-0.585 70.843-46.838 132.903-108.899 179.156z","p-id":"2116",fill:"#388E3C"}}),n("path",{attrs:{d:"M741.507 546.836c0 18.735 15.223 33.958 33.958 33.958s33.958-15.223 33.958-33.958-15.223-33.958-33.958-33.958c-19.32 0-33.958 15.223-33.958 33.958z","p-id":"2117",fill:"#388E3C"}})]),e._v(" "),n("div",{attrs:{slot:"title"},slot:"title"},[n("span",{staticStyle:{"margin-left":"10px"}},[e._v("微信支付")])]),e._v(" "),n("van-radio-group",{attrs:{slot:"right-icon"},slot:"right-icon",model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[n("van-radio",{attrs:{name:"1","checked-color":"#ffcc80"}})],1)],1),e._v(" "),n("van-cell",{attrs:{title:"注意事项"}},[n("div",{attrs:{slot:"label"},slot:"label"},[n("span",[e._v("参赛报名费用: 报名费已经缴纳，不得退换及转让他人；报名信息不全及须加信息的报名视为无效，比赛组委会回味选手材料保密，并有权要求选手补充材料。")]),n("br"),e._v(" "),n("van-checkbox",{staticStyle:{"margin-top":"10px"},attrs:{"checked-color":"#ffcc80"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("阅读并已知晓")])],1)])],2),e._v(" "),n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("van-button",{staticClass:"submit-btn",attrs:{round:"",type:"default"},on:{click:e.goBack}},[e._v("\n      上一步\n    ")]),e._v(" "),n("van-button",{staticClass:"submit-btn",attrs:{round:"",type:"default"},on:{click:e.onSubmit}},[e._v("\n      微信支付\n    ")])],1)],1)},staticRenderFns:[]};var ve=n("VU/8")(de,ue,!1,function(e){n("aFre")},"data-v-64b60315",null).exports,fe={data:function(){return{active:2}},methods:{},components:{"van-steps":O.a,"van-step":q.a,"step-three":ve}},pe={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form"},[n("van-steps",{attrs:{active:e.active,"active-color":"#ffcc80"}},[n("van-step",[e._v("上传证件")]),e._v(" "),n("van-step",[e._v("填写信息")]),e._v(" "),n("van-step",[e._v("支付缴费")]),e._v(" "),n("van-step",[e._v("报名结果")])],1),e._v(" "),n("step-three")],1)},staticRenderFns:[]};var he=n("VU/8")(fe,pe,!1,function(e){n("f4Lf")},"data-v-657a84bf",null).exports,me={data:function(){return{payResult:{status:null,number:"",payTime:"",payType:"",payTotal:"",failReason:""},enrollInfo:{name:"",gender:"",zone:"",group:"",idType:"",idValue:"",phone:"",organization:"",tutor:"",tutorPhone:""},feeInfo:{enrolledEvents:[],totalFee:"",feeInfo:"个人节目为480元/单项, 加项260/项，团体节目（4人元以上）为300元/人，加项零售260/项目",payType:"微信支付",time:"",outTradeNum:""}}},created:function(){window.sessionStorage.getItem("token")?window.sessionStorage.getItem("step2Data")?window.sessionStorage.getItem("step1Data")||this.$router.replace("/step1"):this.$router.replace("/step2"):this.$router.replace("/")},mounted:function(){var e=window.sessionStorage.getItem("token");s.a.defaults.headers={token:e};var t=this;e?(d.a.loading({mask:!0,message:"查询报名信息中...",duration:0}),this.getInfo(e,function(e){if(d.a.clear(),console.log(e),1!==e.order.pay_status)return t.$router.replace("/step3");var n=e;t.payResult.status=n.order.pay_status,t.enrollInfo.name=n.order.real_name,t.enrollInfo.gender=n.order.sex+""=="1"?"男":"女",t.enrollInfo.zone=n.order.address_name,t.enrollInfo.group=n.order.group_name,t.enrollInfo.idType=["","身份证","户口本","护照","港澳通行证"][n.order.card_type],t.enrollInfo.idValue=n.order.card_number,t.enrollInfo.phone=t.enrollInfo.phone="+"+n.userInfo.mobile_code+" "+n.userInfo.mobile,t.enrollInfo.organization=n.order.teacher_organization,t.enrollInfo.tutor=n.order.teacher,t.enrollInfo.tutorPhone=n.order.teacher_mobile,t.enrollInfo.orderId=n.order.order_id,n.orderItem.length>0&&(n.orderItem.map(function(e){t.feeInfo.enrolledEvents.push({type:1===e.sort?"主项":"附加项",event:e.project_name,form:e.form_name,price:e.charge+" "+e.settle_currency})}),t.feeInfo.totalFee=n.order.total_amount+" "+n.order.settle_currency,t.feeInfo.time=n.order.pay_date,t.feeInfo.outTradeNum=n.order.out_trade_no)},function(e){d.a.clear(),d.a.fail(e)})):t.$router.replace("/step2")},methods:{payAgain:function(){this.$router.replace("/step3")},seeDetail:function(){this.$router.push("/info")},goEnroll:function(){window.sessionStorage.clear(),this.$router.push("/step1")},getInfo:function(e,t,n){var a=this;s.a.get("api/MyOrder/info",{headers:{token:e}}).then(function(e){console.log(e),200===e.data.code?t(e.data.data):n("获取报名信息失败！")}).catch(function(e){n(e.response.data.msg),401===e.response.data.code&&a.$router.replace("/step2")})}},components:{"van-button":c.a,"van-cell":P.a,"van-cell-group":$.a}},ge={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("van-cell-group",{staticClass:"round-corner group"},[null!==e.payResult.status?n("div",{staticClass:"header"},[1===e.payResult.status?n("div",{staticClass:"header-type"},[n("svg",{staticClass:"icon",attrs:{t:"1563761156525",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1117",width:"48",height:"48"}},[n("path",{attrs:{d:"M512 0C229.2224 0 0 229.2224 0 512s229.2224 512 512 512 512-229.2224 512-512S794.7776 0 512 0z m244.667733 422.0416l-263.68 263.662933c-6.656 6.673067-15.394133 10.001067-24.132266 10.001067s-17.4592-3.328-24.132267-10.001067l-143.240533-143.240533c-12.032-12.032-14.984533-31.402667-5.0688-45.2096a34.133333 34.133333 0 0 1 51.985066-4.386133l96.3072 96.3072a34.133333 34.133333 0 0 0 48.264534 0l216.746666-216.7296a34.133333 34.133333 0 0 1 51.985067 4.386133c9.949867 13.806933 6.980267 33.1776-5.034667 45.2096z",fill:"#ffcc80","p-id":"1118"}})]),e._v(" "),n("div",{staticClass:"title",staticStyle:{padding:"0 0 0 0"}},[e._v("\n          报名成功\n        ")])]):0===e.payResult.status?n("div",{staticClass:"header-type"},[n("svg",{staticClass:"icon",attrs:{t:"1563761836137",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2216",width:"48",height:"48"}},[n("path",{attrs:{d:"M874.0352 149.9648c-199.953067-199.953067-524.1344-199.953067-724.0704 0-199.953067 199.953067-199.953067 524.1344 0 724.0704 199.953067 199.953067 524.1344 199.953067 724.0704 0 199.953067-199.953067 199.953067-524.117333 0-724.0704z m-194.56 481.245867c12.8512 12.8512 15.138133 33.9456 3.310933 47.752533a34.048 34.048 0 0 1-25.975466 11.9808 33.9968 33.9968 0 0 1-24.132267-10.001067l-96.546133-96.546133a34.133333 34.133333 0 0 0-48.264534 0L391.3216 680.96a34.0992 34.0992 0 0 1-50.107733-1.979733c-11.844267-13.806933-9.557333-34.901333 3.310933-47.752534l95.0784-95.0784a34.133333 34.133333 0 0 0 0-48.264533l-95.266133-95.266133c-12.014933-12.014933-14.933333-31.368533-5.000534-45.175467a34.133333 34.133333 0 0 1 51.985067-4.369067l96.546133 96.546134a34.133333 34.133333 0 0 0 48.264534 0l95.266133-95.266134c12.014933-12.014933 31.368533-14.933333 45.175467-5.000533a34.133333 34.133333 0 0 1 4.369066 51.985067l-96.546133 96.546133a34.133333 34.133333 0 0 0 0 48.264533l95.0784 95.061334z",fill:"#ffcc80","p-id":"2217"}})]),e._v(" "),n("div",{staticClass:"title",staticStyle:{padding:"0 0 0 0"}},[e._v("\n          报名失败\n        ")])]):e._e()]):e._e(),e._v(" "),n("van-cell-group",[n("van-cell",{attrs:{title:"参赛选手姓名",value:e.enrollInfo.name}}),e._v(" "),n("van-cell",{attrs:{title:"参赛选手性别",value:e.enrollInfo.gender}}),e._v(" "),n("van-cell",{attrs:{title:"参赛地区",value:e.enrollInfo.zone}}),e._v(" "),n("van-cell",{attrs:{title:"年龄组别",value:e.enrollInfo.group}}),e._v(" "),n("van-cell",{attrs:{title:"证件类型",value:e.enrollInfo.idType}}),e._v(" "),n("van-cell",{attrs:{title:"证件号码",value:e.enrollInfo.idValue}}),e._v(" "),n("van-cell",{attrs:{title:"联系电话",value:e.enrollInfo.phone}}),e._v(" "),n("van-cell",{attrs:{title:"教育机构/工作室",value:e.enrollInfo.organization}}),e._v(" "),n("van-cell",{attrs:{title:"指导老师",value:e.enrollInfo.tutor}}),e._v(" "),n("van-cell",{attrs:{title:"指导老师电话",value:e.enrollInfo.tutorPhone}})],1)],1),e._v(" "),n("van-cell-group",{staticClass:"round-corner group",staticStyle:{"margin-top":"15px"}},[n("div",{staticClass:"center"},[e._v("\n      项目收费\n    ")]),e._v(" "),e._l(e.feeInfo.enrolledEvents,function(t,a){return n("van-cell-group",{key:a,staticClass:"event"},[n("van-cell",{attrs:{title:t.type}}),e._v(" "),n("van-cell",{attrs:{title:"参赛名称",value:t.event}}),e._v(" "),n("van-cell",{attrs:{title:"参赛形式",value:t.form}}),e._v(" "),n("van-cell",{attrs:{title:"价钱",value:t.price,"value-class":"item-price"}})],1)}),e._v(" "),n("van-cell",{attrs:{title:"费用合计",value:e.feeInfo.totalFee,"title-class":"info-title","value-class":"total-price"}}),e._v(" "),n("van-cell",{staticClass:"top-margin",attrs:{title:"报名费用详情",label:e.feeInfo.feeInfo}}),e._v(" "),n("van-cell",{attrs:{title:"支付方式","title-class":"info-title","value-class":"info-title",value:e.feeInfo.payType}}),e._v(" "),n("van-cell",{attrs:{title:"支付时间","title-class":"info-title","value-class":"info-title flex-two",value:e.feeInfo.time}}),e._v(" "),n("van-cell",{attrs:{title:"订单号","title-class":"info-title","value-class":"info-title flex-two",value:e.feeInfo.outTradeNum}})],2),e._v(" "),0===e.payResult.status?n("div",{staticStyle:{"text-align":"right"}},[n("van-button",{staticClass:"submit-btn",attrs:{type:"danger",round:""},on:{click:e.payAgain}},[e._v("重新支付")])],1):e._e(),e._v(" "),1===e.payResult.status?n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("van-button",{staticClass:"submit-btn",attrs:{plain:"",type:"default",round:""},on:{click:e.seeDetail}},[e._v("查看报名信息")]),e._v(" "),n("van-button",{staticClass:"submit-btn",attrs:{type:"danger",round:""},on:{click:e.goEnroll}},[e._v("继续报名")])],1):e._e()],1)},staticRenderFns:[]};var _e=n("VU/8")(me,ge,!1,function(e){n("oCLk")},"data-v-e586b440",null).exports,Ie={data:function(){return{active:3}},methods:{},components:{"van-steps":O.a,"van-step":q.a,"step-four":_e}},be={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form"},[n("van-steps",{attrs:{active:e.active,"active-color":"#ffcc80"}},[n("van-step",[e._v("上传证件")]),e._v(" "),n("van-step",[e._v("填写信息")]),e._v(" "),n("van-step",[e._v("支付缴费")]),e._v(" "),n("van-step",[e._v("报名结果")])],1),e._v(" "),n("step-four")],1)},staticRenderFns:[]};var we=n("VU/8")(Ie,be,!1,function(e){n("Coeh")},"data-v-090b6c92",null).exports;o.a.use(r.a);var Ce=[{path:"/",name:"Entry",components:{default:w},meta:{title:"澳之星大赛"}},{path:"/eventDetail",name:"EventDetail",components:{default:E},meta:{title:"澳之星报名项目详情"}},{path:"/step1",name:"Step1",components:{default:Y},meta:{title:"澳之星报名-第一步"}},{path:"/step2",name:"Step2",components:{default:re},meta:{title:"澳之星报名-第二步"}},{path:"/step3",name:"Step3",components:{default:he},meta:{title:"澳之星报名-第三步"}},{path:"/step4",name:"Step4",components:{default:we},meta:{title:"澳之星报名-第四步"}},{path:"/queryInfo",name:"QueryInfo",components:{default:L},meta:{title:"澳之星大赛-入口"}},{path:"/info",name:"Info",components:{default:W},meta:{title:"澳之星报名信息"}}],ye=new r.a({mode:"history",routes:Ce}),xe={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var Se,ke,ze,Ee,Te,Ae=n("VU/8")({name:"App"},xe,!1,function(e){n("Gypb")},null,null).exports,Me=function(){ye.beforeEach(function(e,t,n){console.log(e.fullPath),e.meta.title&&(document.title=e.meta.title),n()}),ye.afterEach(function(){window.scrollTo(0,0)})},$e=function(){s.a.defaults.baseURL="https://star.zdb.im/",s.a.defaults.headers={"content-type":"application/json"},o.a.prototype.$wx=i.a,o.a.use(a.a),new o.a({el:"#app",router:ye,components:{App:Ae},template:"<App/>"})};if(window.sessionStorage.getItem("token"))Me(),$e();else if(h())if(console.log("session 中没有token"),window.sessionStorage.getItem("openId"))Me(),$e();else{var Fe=(Se="openId",ke=new RegExp("(^|&)"+Se+"=([^&]*)(&|$)","i"),ze=new RegExp("(^|/)"+Se+"/([^/]*)(/|$)","i"),Ee=window.location.search.substr(1).match(ke),Te=window.location.pathname.substr(1).match(ze),null!=Ee?unescape(Ee[2]):null!=Te?unescape(Te[2]):null);if(Fe){window.sessionStorage.setItem("openId",Fe);var je=window.location.href.slice(0,window.location.href.indexOf("?"));window.location.replace(je)}else window.location.replace("https://star.zdb.im/api/Login/index")}else Me(),$e()},PCFi:function(e,t){},PVvA:function(e,t){},Pf0w:function(e,t){},RGxH:function(e,t){},UTD0:function(e,t){},W0KU:function(e,t){},aFre:function(e,t){},bvUi:function(e,t){},eh36:function(e,t){},f4Lf:function(e,t){},hW8u:function(e,t){},kXkE:function(e,t){},nOtf:function(e,t){},nsZj:function(e,t){},oCLk:function(e,t){},pUlv:function(e,t){},pbW4:function(e,t){},px3J:function(e,t){},v2ns:function(e,t){},xT4F:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.8340c35577c57e8a420e.js.map